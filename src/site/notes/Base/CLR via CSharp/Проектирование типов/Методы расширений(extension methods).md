---
dg-publish: true
---

Методы расширения - позволяют добавлять новые методы в уже существующие типы без создания нового производного класса.

```csharp
public static возвращаемый_тип название_метода( this имя_расширяемого_тип название_параметра, [параметры])
{  
}
```

Расширение типа StringBuilder, посредством добавление метода поиска индекса символа

```csharp

public static Int32 IndexOf(this StringBuilder sb, Char value)
{
	for (Int32 index = 0; index < sb.Length; index++)
		if (sb[index] == value) return index;
	return -1;
}

```

Используется как обычный вызов метода класса StringBuilder
```csharp
Int32 index = sb.IndexOf('X');
```

Как компилятор обнаруживает методы расширений:
1. Сначала он проверит класс StringBuilder или все его базовые классы, предоставляющие экземплярные методы с именем IndexOf и единственным параметром Char.
2. Если они не существуют, тогда компилятор будет искать любой статический класс с определенным методом IndexOf, у которого первый параметр соответствует типу выражения, используемого при вызове метода. Этот тип должен быть отмечен при помощи ключевого слова this.

##### Атрибут расширения

В языке С#, когда вы помечаете первый параметр статичного метода ключевым словом this, компилятор применяет соответствующий атрибут к методу, и данный атрибут сохраняется в метаданных результирующего файла. К тому же этот атрибут применяется к метаданным любого статического класса, содержащего, по крайней мере, один метод расширения

Итак, когда скомпилированный код вызывает экземплярный метод, компилятор может быстро просканировать все ссылающиеся сборки, чтобы определить, какая из них содержит методы расширения. 

В дальнейшем он может сканировать только те сборки статических классов, которые **содержат методы расширения**, выполняя поиск потенциальных соответствий компилируемому коду настолько быстро, насколько это возможно.

Этот атрибут определен в сборке System.Core.dll и выглядит следующим образом:
```csharp
	
// Определен в пространстве имен System.Runtime.CompilerServices
[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class | AttributeTargets.Assembly)]
public sealed class ExtensionAttribute : Attribute
{}
```

