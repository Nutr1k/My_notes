---
dg-publish: true
---

Алгоритм k-ближайших соседей - классификация предмета по его ближайшим соседям.
У алгоритма k-ближайших соседей есть два основным применения:
1. Классификация = распределение по категориям.
2. Регрессия = прогнозирование ответа (в числовом выражении)ж

К какой категории относится загадочный фрукт:
А - апельсины, Г - грейпфруты.
![Pasted image 20230123173041.png](/img/user/Files/Image/Pasted%20image%2020230123173041.png)

Рассмотрит их признаки в системе координат и возьмём ближайших соседей.
![Pasted image 20230123173232.png](/img/user/Files/Image/Pasted%20image%2020230123173232.png)

Т.к. соседей апельсинов больше чем грейпфрутов, то наш загадочный фрукт скорее **Апельсин**

Алгоритм:
![Pasted image 20230123173357.png](/img/user/Files/Image/Pasted%20image%2020230123173357.png)

### Построение рекомендательной системы:

К примеру мы работает в Netflix и хотим построить систему, которая будет рекомендовать фильмы для наших пользователей.
Фильм, который понравиться соседям Приянки скорее всего понравиться и ей.
![Pasted image 20230123175649.png](/img/user/Files/Image/Pasted%20image%2020230123175649.png)

У Джастина, Джей-Си, Джозефа, Ланса и Криса похожие вкусы. **Значит, те фильмы, которые нравятся им, с большей вероятностью понравятся и Приянке!**

>Чтобы рекомендовать фильм или не рекомендовать, нужно вычислить среднее арифметическое оценок ваших соседей за этот фильм и уже на основе это оценке делать рекомендации.

Фильмы которые им не понравились скорее всего не понравятся и вам.
![Pasted image 20230123175831.png](/img/user/Files/Image/Pasted%20image%2020230123175831.png)

**Когда мы строим рекомендательную систему фильмов нам нужны признаки, по которым можно классифицировать являются ли пользователи соседями или нет.**
Чтобы нанести пользователей на график, нам нужно извлечь из них признаки. При регистрации требуем чтобы они указали какие категории им нравятся. 

> Извлечением признаков называется преобразование элемента (например, фрукта или пользователя) в список чисел, которые могут использоваться для сравнения.

Под правильным выбором признаков следует понимать:
1. Признаки напрямую связанны с фильмами, которые вы пытаетесь рекомендовать
2. Признаки, не содержащие смещения (например если предлагать пользователям оценивать только комедии, вы не получите никакой информации об их отношении к боевикам)

Если мы к примеру будем предлагать оценить пользователям фильмы: История игрушек-1,История игрушек-2,История игрушек-3. Эти оценки ничего не скажут о вкусах пользователях, единственное что они скажут, это их отношения к мультфильмам и комедиям.
![Pasted image 20230123180222.png|480](/img/user/Files/Image/Pasted%20image%2020230123180222.png)

По этим данным не составит труда нанести пользователей на координатную плоскость и найти соседей.

**Категорий фильмов может быть сколько угодно, каждая категория фильм это просто дополнительная координатная ось**

Судить о том, являются ли пользователи соседями или нет можно c помощью формулы _расстояния между_ точками и с помощью _близости косинусов_

### Расстояние между точками
Формула расстояние между точками работает для сколько угодных координатных осей (3,4,5,6 мерный координатные плоскости)

$$d=\sqrt[2]{(a_2-a_1)^{2}+(b_2-b_1)^{2}+(c_2-c_1)^{2}+(d_2-d_1)^{2}+(e_2-e_1)^{2}}$$

Расстояние между Приянкой и Джастином:

$d=\sqrt[2]{(3-4)^{2}+(4-3)^{2}+(4-5)^{2}+(1-1)^{2}+(4-5)^{2}}=2$

Их вкусы похожи. Фильм, который понравиться Джастину можно порекомендовать его Приянке, и на оборот.


Расстояние между Приянкой и Морфеусом:

$d=\sqrt[2]{(3-2)^{2}+(4-5)^{2}+(4-1)^{2}+(1-3)^{2}+(4-1)^{2}}=2\sqrt[2]{6}$

Расстояние является большим => вряд ли фильм, который понравится Морфеусу, понравится и Приянке.

**Некоторые полезные особенности построения рекомендательной системы:**
[[grokaem_algoritmy.pdf#page=288|Грокаем алгоитмы]]


### Регрессия 
К примеру мы хотим спрогнозировать какую оценку Приянка поставит фильму. Возьмём 5 ближайших соседей и посмотрим какие оценки поставили её соседи.
![Pasted image 20230123213450.png](/img/user/Files/Image/Pasted%20image%2020230123213450.png)

Если вычислить среднее арифметические их оценок, мы получим 4.2. Такой метод прогнозирования называется регрессией.

К примеру мы открыли булочную и выпекаем там хлеб каждый день. Мы хотим спрогнозировать сколько булок нужно выпечь на сегодня.

Есть несколько признаков которые на это влияют:
1. Погода по шкале от 1 до 5 (1=плохая, 5=отличная);
2. Праздник, выходной, или рабочий день? (1=выходной или праздник, 0= рабочий день)
3. Проходят ли сегодня спортивные игры(1=да, 0=нет)

Мы знаем сколько буханок хлеба было продано в прошлом при разных сочетаниях признаков.
![Pasted image 20230123215504.png](/img/user/Files/Image/Pasted%20image%2020230123215504.png)

Сегодня выходной день и хорошая погода. Сколько буханок следует испечь на основы этих данных?

$$(4,1,0)=?$$

Ниже перечисленны расстояния от точки (4,1,0) до остальных:

A. 1 <-
B. 2 <-
C. 9
D. 2 <-
E. 1 <-
F. 5

A,В,D,E являются ближайшими соседями. Вычислим среднее арифметическое продаж в эти дни.

$$\frac{330+225+200+150}{4}=218,75$$

Значит 218,75 буханки следует испечь.


### Близость косинусов
Вместо вычисления расстояния между точками можно измерят углы двух векторов (метрика близости косинусов).
